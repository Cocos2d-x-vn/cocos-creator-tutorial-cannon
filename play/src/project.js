require=function e(t,o,n){function i(c,a){if(!o[c]){if(!t[c]){var s="function"==typeof require&&require;if(!a&&s)return s(c,!0);if(r)return r(c,!0);var l=new Error("Cannot find module '"+c+"'");throw l.code="MODULE_NOT_FOUND",l}var p=o[c]={exports:{}};t[c][0].call(p.exports,function(e){var o=t[c][1][e];return i(o?o:e)},p,p.exports,e,t,o,n)}return o[c].exports}for(var r="function"==typeof require&&require,c=0;c<n.length;c++)i(n[c]);return i}({bullet:[function(e,t,o){"use strict";cc._RFpush(t,"94553LojOJE4onjq5vJG9e7","bullet");var n=Math.acos,i=Math.sqrt,r=Math.PI,c=function(e){return 180*e/r};cc.Class({"extends":cc.Component,properties:{body:null,timeToLive:0},onLoad:function(){this.timeToLive=1e4,this.lifeTime=0},update:function(e){if(cc.isValid(this.node)&&this.body){var t=this.body,o=t.p,r=o.x,a=o.y,s=t.vx,l=t.vy;this.node.x=r,this.node.y=a,this.lifeTime+=1e3*e,this.node.setRotation(c(n(l/i(s*s+l*l)))),this.lifeTime>=this.timeToLive&&this.node.destroy()}},setBody:function(e){this.body=e}}),cc._RFpop()},{}],cannon:[function(e,t,o){"use strict";cc._RFpush(t,"ee952WxP3lOz7yPVVQsiO17","cannon");var n=Math.cos,i=Math.sin,r=Math.PI,c=function(e){return e*r/180},a=function(e){return n(c(e))},s=function(e){return i(c(e))},l=function(e,t,o){return t>e?t:e>o?o:e};cc.Class({"extends":cc.Component,properties:{barrelSprite:{"default":null,type:cc.SpriteFrame},tankSprite:{"default":null,type:cc.SpriteFrame},barrelPosition:0,angle:0,baseAngleSpeed:0,angleSpeed:0,leftMaxAngle:0,rightMaxAngle:0},onLoad:function(){var e=this.barrelNode=new cc.Node("barrel"),t=e.addComponent(cc.Sprite);t.spriteFrame=this.barrelSprite,e.setAnchorPoint(.5,0),this.node.addChild(e);var o=this.tankNode=new cc.Node("tank"),n=o.addComponent(cc.Sprite);n.spriteFrame=this.tankSprite,this.node.addChild(o),this.barrelPosition=o.height/2-2,e.setPosition(0,this.barrelPosition),this.hookInput(),this.updatePostion()},hookInput:function(){var e=this;cc.eventManager.addListener({event:cc.EventListener.KEYBOARD,onKeyPressed:function(t,o){switch(t){case cc.KEY.left:e.angleSpeed=-1*e.baseAngleSpeed;break;case cc.KEY.right:e.angleSpeed=e.baseAngleSpeed;break;case cc.KEY.space:var n=e.barrelNode.convertToWorldSpaceAR(cc.v2(0,0)),i=e.barrelNode.rotation,r=e.barrelNode.height;n.x+=r*s(i),n.y+=r*a(i),cc.find("/game").getComponent("game").createBullet(n.x,n.y,400,i)}},onKeyReleased:function(t,o){switch(t){case cc.KEY.left:case cc.KEY.right:e.angleSpeed=0}}},this.node)},updatePostion:function(){var e=this.angle,t=this.barrelPosition;this.barrelNode.setRotation(e),this.barrelNode.setPosition(t*s(e),t*a(e))},update:function(e){var t=this.angleSpeed;0!==t&&(this.angle=l(this.angle+t*e,this.leftMaxAngle,this.rightMaxAngle),this.updatePostion())}}),cc._RFpop()},{}],"delete-anim-on-complete":[function(e,t,o){"use strict";cc._RFpush(t,"95264kzSndJArUdf3G1UBsV","delete-anim-on-complete"),cc.Class({"extends":cc.Component,properties:{},onLoad:function(){},onAnimComplete:function(){this.node.destroy()}}),cc._RFpop()},{}],game:[function(e,t,o){"use strict";function n(e,t,o){var n=new cp.Body(e,t);return n.userData=o,n}function i(e){var t=e.width,o=e.height;return[-t/2,-o/2,-t/2,o/2,t/2,o/2,t/2,-o/2]}cc._RFpush(t,"2092bLDIShKfYNzSeNairs7","game");var r=Math.cos,c=Math.sin,a=Math.PI,s=Math.random,l=function(e){return e*a/180},p=function(e){return r(l(e))},d=function(e){return c(l(e))},u=function(e,t){return e+(t-e)*s()},h=1,m=2,f=3;cc.Class({"extends":cc.Component,properties:{space:null,gravity:0,bulletSprite:{"default":null,type:cc.SpriteFrame},meteorSprite:{"default":null,type:cc.SpriteFrame},bulletMeteorExplosion:{"default":null,type:cc.Prefab},meteorGroundExplosion:{"default":null,type:cc.Prefab},meteorTailParticles:{"default":null,type:cc.Prefab},meteorExplodeInTheAirSFX:{"default":null,url:cc.AudioClip},meteorHitTheGroundSFX:{"default":null,url:cc.AudioClip},meteorSpawnMinX:0,meteorSpawnMaxX:0,meteorSpawnMinY:0,meteorSpawnMaxY:0,meteorMinVelocity:0,meteorMaxVelocity:0},onLoad:function(){var e=this;this.space=new cp.Space,this.space.gravity=cp.v(0,this.gravity);var t=new cp.SegmentShape(this.space.staticBody,cp.v(0,100),cp.v(2e3,100),10);t.setCollisionType(f),this.space.addStaticShape(t),this.bulletVerts=i(this.bulletSprite.getRect()),this.meteorVerts=i(this.meteorSprite.getRect());var o=this.shapesToRemove=[];this.space.addCollisionHandler(h,m,function(t,n){var i=t.a,r=t.b;o.push(i),o.push(r);var c=i.body.userData,a=cc.instantiate(e.bulletMeteorExplosion);return a.setPosition(c.position.x,c.position.y),cc.director.getScene().addChild(a),a.getComponent(cc.Animation).play(),cc.audioEngine.playEffect(e.meteorExplodeInTheAirSFX,!1),!0}),this.space.addCollisionHandler(f,h,function(t,n){var i=t.b;o.push(i);var r=i.body.userData,c=cc.instantiate(e.meteorGroundExplosion);return c.setPosition(r.position.x,r.position.y),cc.director.getScene().addChild(c),c.getComponent(cc.Animation).play(),cc.audioEngine.playEffect(e.meteorHitTheGroundSFX,!1),!0})},start:function(){this.scheduleCreateMeteor()},createBullet:function(e,t,o,i){console.log("create bulet",{x:e,y:t,velocity:o,angle:i});var r=new cc.Node,c=r.addComponent(cc.Sprite);c.spriteFrame=this.bulletSprite;r.position=cc.v2(e,t);r.setRotation(i);var a=this.bulletVerts,s=n(1,cp.momentForPoly(1,a,cp.vzero),r);s.setPos(r.position),s.setVel(cp.v(d(i)*o,p(i)*o)),this.space.addBody(s);var l=new cp.PolyShape(s,a,cp.vzero);l.e=.5,l.u=.5,l.setCollisionType(m),this.space.addShape(l),r.addComponent("bullet").setBody(s),cc.director.getScene().addChild(r)},scheduleCreateMeteor:function(){cc.director.getScheduler().schedule(this.createMeteor,this,1+1*s(),!1)},createMeteorAndScheduleNext:function(){this.createMeteor(),this.scheduleCreateMeteor()},createMeteor:function(){var e=u(this.meteorSpawnMinX,this.meteorSpawnMaxX),t=u(this.meteorSpawnMinY,this.meteorSpawnMaxY),o=115+20*s(),i=u(this.meteorMinVelocity,this.meteorMaxVelocity),r=new cc.Node;r.addComponent(cc.ParticleSystem).file=cc.url.raw("/particles/meteor-tail-particles.plist"),r.addComponent(cc.Sprite).spriteFrame=this.meteorSprite,r.setPosition(cc.v2(e,t));var c=this.meteorVerts,a=n(1,cp.momentForPoly(1,c,cp.vzero),r);a.setPos(r.position),a.setVel(cp.v(d(o)*i,p(o)*i)),this.space.addBody(a);var l=new cp.PolyShape(a,c,cp.vzero);l.e=.5,l.u=.5,l.setCollisionType(h),this.space.addShape(l);var m=r.addComponent("meteor");m.setBody(a),cc.director.getScene().addChild(r)},update:function(e){var t=this.space,o=this.shapesToRemove;if(t&&(t.step(e),o.length>0)){for(var n=0;n<o.length;n++){var i=o[n];t.removeShape(i),t.removeBody(i.body),i.body.userData.destroy()}o.length=0}}}),cc._RFpop()},{}],meteor:[function(e,t,o){"use strict";cc._RFpush(t,"5527aRANMxFiLQlHAm0xlFB","meteor"),cc.Class({"extends":cc.Component,properties:{},onLoad:function(){},setBody:function(e){this.body=e},setTail:function(e){this.tail=e,this.node.addChild(e)},update:function(e){if(cc.isValid(this.node)&&this.body){var t=this.body,o=t.p,n=o.x,i=o.y;t.vx,t.vy;this.node.x=n,this.node.y=i}}}),cc._RFpop()},{}]},{},["game","meteor","bullet","delete-anim-on-complete","cannon"]);